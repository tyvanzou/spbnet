NOTE: only `buildModal`, `predAgc`, `attn`, and `feat` has been tested. Since other code is used to draw figure in the paper and may be not well maintained.